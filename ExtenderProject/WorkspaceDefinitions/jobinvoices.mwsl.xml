<?xml version="1.0" encoding="UTF-8"?>
<!-- SBA, 17/03/11: New workspace for looking up and crediting job invoices	(39489).	-->
<!-- SBA, 26/10/11: Improve performance of dynamic workspace (40105). -->
<MWSL xmlns="http://www.deltek.com/ns/mwsl" version="0.23">
  <Workspace name="JobInvoices" title="Job Invoices">
    <Filter source="JobInvoiceOverview" title="Job Invoice List" view="Standard">
      <Formation>
        <Section title="Home">
          <With>
            <Card view="Overview" title="Overview">
              <Expansions>
                <Bind foreignKey="primary">
                  <Table source="ShowJobInvoice" title="Specification" hidden="parent.DebitCredit = DebitCreditType'Credit" view="Demo" />
                </Bind>
                <Bind foreignKey="primary">
                  <Table source="ShowJobCreditMemo" title="Specification" hidden="parent.DebitCredit = DebitCreditType'Debit" view="Full" />
                </Bind>
                <With>
                  <Table view="Demo" title="Foundation" hidden="not parent.ContainsFoundationVar" />
                </With>
                <Bind foreignKey="primary">
                  <Table source="ShowJobInvoiceReconciliations" view="Full" title="On Account Reconciliations" hidden="not parent.ReconcilesJobInvoicesOnAccountVar" />
                </Bind>
                <Restrict reversedForeignKey="InvoiceNumber_Invoice">
                  <Filter source="ShowJobInvoiceOnAccountReconciliations" title="Reconciliations" view="Standard" hidden="not parent.ReconciliationsByInvoicesExistVar" />
                </Restrict>
              </Expansions>
            </Card>
          </With>
          <Mount>
          	<Workspace source="SD_InvoiceDraftStatus" />
          </Mount>
        </Section>
        <Section title="Crediting" hidden="not (parent.Origin = InvoiceOriginType'\Job Cost Invoice\ and parent.DebitCredit = DebitCreditType'Debit)">
          <Bind foreignKey="primary">
            <Card source="JobInvoiceCrediting" view="Crediting" title="Credit Invoice" hidden="not (parent.Origin = InvoiceOriginType'\Job Cost Invoice\ and parent.DebitCredit = DebitCreditType'Debit)">
              <Expansions>
                <With>
                  <Table view="Full" title="Original Specification" />
                </With>
                <Bind foreignKey="Card_InvoiceEditingHeader">
                  <Hidden source="InvoiceEditing">
                    <With>
                      <Table view="Crediting" title="New Specification" hidden="parent.parent.InvoiceEditingNumberVar = ''" />
                    </With>
                  </Hidden>
                </Bind>
              </Expansions>
            </Card>
            <Card source="JobInvoiceCrediting" view="NewInvoice" title="New Invoice" hidden="FullyCreditedInvoiceNumberVar = 0">
              <Expansions>
                <With>
                  <Table view="Full" title="Original Specification" />
                </With>
              </Expansions>
            </Card>
          </Bind>
        </Section>
      </Formation>
    </Filter>
  </Workspace>
</MWSL>

