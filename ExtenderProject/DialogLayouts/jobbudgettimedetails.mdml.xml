<?xml version="1.0" encoding="UTF-8"?>
<!-- RMA, 06/04/09: Create empty forms for every dialog (37642).-->
<!-- SJK, 20/04/09: new table 'Standard' (37651).-->
<!-- SJK, 10/06/09: Next version of JobEstimating (37767).-->
<!-- JSV, 02/07/09: Insert Original layout converted from mdl and filter layout (37802).-->
<!-- MJA, 27/10/09: Update Original layout and remove Empty layout (37802).-->
<!-- SJK, 20/01/10: Deleted Standard (37767).-->
<!-- SJK, 22/09/10: demo layout added (38887).-->
<!-- JSV, 29/11/10: Compact block for Original filter (39106).-->
<!-- PSZ, 03/12/10: Use onDemand suggestions for relevant fields (39127).-->
<!-- JSV, 24/08/11: Use reference element where possible (39874).-->
<!-- SJK, 09/11/11: Table is only editable if budget has been created (40131).-->
<MDML xmlns="http://www.deltek.com/ns/mdml" version="0.59">
  <Layout source="JobBudgetTimeDetails">
    <FilterPane>
      <Filter name="Standard">
        <Compact>
          <Description template="Job No. ^1, ^2, Revision ^3, Line No. ^4, ^5" arguments="JobNumber;BudgetType;RevisionNumber;LineNumber;Text" />
        </Compact>
        <Columns>
          <Field source="JobNumber" />
          <Field source="BudgetType" />
          <Field source="RevisionNumber" />
          <Field source="ChangedInRevisionNumber" />
          <Field source="LineNumber" />
          <Field source="IncludedInFixedPrice" />
          <Field source="ActivityNumber" />
          <Field source="TaskName" />
          <Field source="EmployeeCategoryNumber" />
          <Field source="EmployeeNumber" />
        </Columns>
      </Filter>
    </FilterPane>
    <UpperPane>
      <Form name="Full">
        <Actions all="true" />
        <Row>
          <Column>
            <Group title="Job Budget">
              <Reference foreignKey="JobNumber_JobHeader" />
              <Field source="BudgetType" />
              <Field source="RevisionNumber" />
            </Group>
          </Column>
          <Column>
            <Group title="Budget Line">
              <Field source="Text" />
              <Field source="Remark" />
              <Field source="TaskName" />
              <Field source="ActivityNumber" />
            </Group>
          </Column>
        </Row>
      </Form>
    </UpperPane>
    <LowerPane>
      <Define>
        <Function name="canReadCostPriceForTime" value="booleanEnvVar('user.info.CanReadCostPriceForTime')" />
        <Function name="canChangeCostPriceForTime" value="booleanEnvVar('user.info.CanChangeCostPriceForTime')" />
      </Define>
      <Table name="Full">
        <Actions all="true" />
        <Columns>
          <Field source="Heading" />
          <Field source="EmployeeCategoryNumber" />
          <Field source="EmployeeCategoryNameVar" />
          <Field source="EmployeeNumber" />
          <Field source="EmployeeNameVar" />
          <Field source="NumberOfVar" />
          <Field source="ShowCostPriceBaseVar" />
          <Field source="ShowMarkupPercentageVar" />
          <Field source="BillingPriceCurrencyVar" />
          <Field source="BillingPriceBaseVar" />
          <Field source="ShowTotalCostPriceBaseVar" />
          <Field source="BillingPriceCurrencyTotalVar" />
          <Field source="BillingPriceBaseTotalVar" />
          <Field source="StdBillingPriceCurrencyVar" />
          <Field source="StdBillingPriceTotalCurrencyVar" />
          <Field source="StdBillingPriceBaseVar" />
          <Field source="StdBillingPriceTotalBaseVar" />
          <Field source="NumberOfManDaysVar" />
          <Field source="ShowCostPricePerDayBaseVar" />
          <Field source="BillingPriceCurrencyPerDayVar" />
          <Field source="BillingPriceBasePerDayVar" />
          <Field source="StdBillingPriceCurrencyPerDayVar" />
          <Field source="StdBillingPriceBasePerDayVar" />
        </Columns>
      </Table>
      <Table name="Demo">
        <Actions all="not hasWorkspace('OpportunityBudgeting') or parent.parent.parent.BudgetCreatedVar or parent.parent.BudgetCreatedVar" />
        <Columns>
          <Field source="Heading" />
          <Field source="NumberOfVar" />
          <If condition="canReadCostPriceForTime()">
            <Field source="ShowCostPriceBaseVar" open="canChangeCostPriceForTime()" />
            <Field source="ShowMarkupPercentageVar" />
          </If>
          <Field source="BillingPriceCurrencyVar" />
          <If condition="canReadCostPriceForTime()">
            <Field source="ShowTotalCostPriceBaseVar" open="canChangeCostPriceForTime()" />
          </If>
          <Field source="BillingPriceCurrencyTotalVar" />
        </Columns>
      </Table>
      <Table name="Custom">
        <Actions all="not hasWorkspace('OpportunityBudgeting') or parent.parent.parent.BudgetCreatedVar or parent.parent.BudgetCreatedVar" />
        <Columns>
          <Field source="Heading" />
          <Field source="NumberOfVar" />
          <If condition="canReadCostPriceForTime()">
            <Field source="ShowCostPriceBaseVar" open="canChangeCostPriceForTime()" />
            <Field source="ShowMarkupPercentageVar" />
          </If>
          <If condition="parent.parent.ShowBudgetTypeVar=jobbudgettypetype'\contract budget\">
          	<Field source="BillingPriceCurrencyVar" />
          </If>
          <If condition="canReadCostPriceForTime()">
            <Field source="ShowTotalCostPriceBaseVar" open="canChangeCostPriceForTime()" />
          </If>
          <If condition="parent.parent.ShowBudgetTypeVar=jobbudgettypetype'\contract budget\">
          	<Field source="BillingPriceCurrencyTotalVar" />
          </If>
        </Columns>
      </Table>
      <Table name="Custom_Time">
        <Actions all="not hasWorkspace('OpportunityBudgeting') or parent.parent.parent.BudgetCreatedVar or parent.parent.BudgetCreatedVar" />
        <Columns>
          <Field source="Heading" />
          <Field source="NumberOfVar" />
            <Field source="ShowCostPriceBaseVar" />
          <If condition="parent.parent.parent.ShowBudgetTypeVar=jobbudgettypetype'\contract budget\">
          	<Field source="BillingPriceCurrencyVar" />
          </If>
            <Field source="ShowTotalCostPriceBaseVar" />
          <If condition="parent.parent.parent.ShowBudgetTypeVar=jobbudgettypetype'\contract budget\">
          	<Field source="BillingPriceCurrencyTotalVar" />
          </If>
        </Columns>
      </Table>
    </LowerPane>
  </Layout>
</MDML>

