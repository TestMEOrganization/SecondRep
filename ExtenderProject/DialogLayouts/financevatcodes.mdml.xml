<?xml version="1.0" encoding="UTF-8"?>
<!-- RMA, 06/04/09: Create empty forms for every dialog (37642).-->
<!-- JSV, 02/07/09: Insert Original layout converted from mdl and filter layout (37802).-->
<!-- MJA, 27/10/09: Update Original layout and remove Empty layout (37802).-->
<!-- JSV, 29/04/10: Use FullBoolean for Boolean fields open in new or update state (38472).-->
<!-- KUN, 07/07/10: Added group and columns for user update information (38625).-->
<!-- PBO, 22/09/10: Implement conditional layout (38843).-->
<!-- JSV, 29/11/10: Compact block for Original filter (39106).-->
<!-- KUN, 11/04/11: Added supplement fields for account references (39544). -->
<!-- CSK, 27/04/11: DimensionOrigin view added (39547).-->
<!-- PSZ, 20/06/11: Original layout should be placed as the first layout (39299).-->
<!-- KUN, 09/08/11: New layouts to support the Tax setup workspace (39544). -->
<!-- PSZ, 05/10/11: Add shadow titles for selected relations (40004).-->
<!-- CSK, 10/10/11: Alignment in DimensionOrigin form (39547).-->
<!-- CSK, 11/10/11: Possible to edit account in DimensionOrigin (39547).-->
<!-- CSK, 19/10/11: New removed from creation wizard title (40064).-->
<MDML xmlns="http://www.deltek.com/ns/mdml" version="0.59">
  <Layout source="FinanceVATCodes">
    <FilterPane>
      <Filter name="Standard">
        <Compact>
          <Description template="^1" arguments="Name" />
        </Compact>
        <Columns>
          <Field source="Name" />
          <Field source="VATRate" />
          <Field source="RatioNumber" />
          <Field source="VATDirection" />
          <Field source="VATNature" />
          <Field source="VATType" />
          <Field source="EUAcquisitionVATCode" />
          <Field source="EUAcquisitionVATRate" />
          <Field source="InvestmentTaxRate" />
          <Field source="FinanceVATLevel" />
        </Columns>
      </Filter>
      <Filter name="VATSetup">
        <Actions>
          <Action source="with.Create" wizard="CreateVATCodeWizard" />
        </Actions>
        <Compact>
          <Description template="^1" arguments="Name" />
        </Compact>
        <Columns>
          <Field source="Name" />
          <Field source="VATRate" />
          <Field source="RatioNumber" />
          <Field source="VATDirection" />
          <Field source="VATNature" />
          <Field source="VATType" />
          <Field source="EUAcquisitionVATCode" />
          <Field source="EUAcquisitionVATRate" />
          <Field source="InvestmentTaxRate" />
          <Field source="FinanceVATLevel" />
        </Columns>
      </Filter>
    </FilterPane>
    <UpperPane>
      <Define>
        <Function name="isAccount" parameters="FieldPar" value="FieldPar=Parent.DimensionCombNumber" />
      </Define>
      <Wizard name="CreateVATCodeWizard" title="Create Tax Code">
        <Page form="CreateVATCodePage1" title="Tax Code" />
        <Page form="CreateVATCodePage2" title="Rates" />
        <Page form="CreateVATCodePage3" title="Posting References" />
      </Wizard>
      <Form name="Full" title="G/L Tax Code">
        <Actions all="true" />
        <Row>
          <Column>
            <Group title="G/L Tax Code">
              <Field source="Name" />
              <Field source="VATRate" />
              <Field source="RatioNumber" />
              <Field source="VATDirection" />
              <Field source="VATNature" />
              <Field source="VATType" />
              <If condition="maconomy:booleanSysPar('UseMultipleVATLevels')">
                <Field source="FinanceVATLevel" />
                <Boolean source="CalculateVATOfVAT" />
              </If>
              <BooleanGroup title="">
                <Boolean source="EUAcquisitionVATCode" />
              </BooleanGroup>
              <Field source="EUAcquisitionVATRate" />
            </Group>
            <Group title="Investment Tax">
              <Field source="InvestmentTaxRate" />
              <Field source="EntryTextInvestmentTax" />
              <Boolean source="CreateJobEntryInvestmentTax" />
            </Group>
          </Column>
          <Column>
            <Group title="Posting References">
              <Reference foreignKey="FinanceAccountVAT_DimensionCombHeader" />
              <Reference foreignKey="FinanceAccountReconciliation_DimensionCombHeader" />
              <Reference foreignKey="FinanceAccountEUVAT_DimensionCombHeader" />
              <Reference foreignKey="FinanceAccountInvestmentTax_DimensionCombHeader" />
              <Reference foreignKey="SetOffAccountInvestmentTax_DimensionCombHeader" />
              <Reference foreignKey="FinanceAccountBase_DimensionCombHeader" />
            </Group>
            <Group title="Access Level">
              <Reference foreignKey="AccessLevelName_AccessLevelHeader" keyShadowTitle="Name" descriptionShadowTitle="Description" />
            </Group>
            <Group ref="UserUpdateGroup" />
          </Column>
        </Row>
      </Form>
      <Form name="DetailedVATSetup" title="G/L Tax Code">
        <Actions all="true">
          <Exclude>
            <Create />
          </Exclude>
        </Actions>
        <Row>
          <Column>
            <Group title="G/L Tax Code">
              <Field source="Name" />
              <Field source="VATRate" />
              <Field source="RatioNumber" />
              <Field source="VATDirection" />
              <Field source="VATNature" />
              <Field source="VATType" />
              <If condition="maconomy:booleanSysPar('UseMultipleVATLevels')">
                <Field source="FinanceVATLevel" />
                <Boolean source="CalculateVATOfVAT" />
              </If>
              <BooleanGroup title="">
                <Boolean source="EUAcquisitionVATCode" />
              </BooleanGroup>
              <Field source="EUAcquisitionVATRate" />
            </Group>
            <Group title="Investment Tax">
              <Field source="InvestmentTaxRate" />
              <Field source="EntryTextInvestmentTax" />
              <Boolean source="CreateJobEntryInvestmentTax" />
            </Group>
          </Column>
          <Column>
            <Group title="Posting References">
              <Reference foreignKey="FinanceAccountVAT_DimensionCombHeader" />
              <Reference foreignKey="FinanceAccountReconciliation_DimensionCombHeader" />
              <Reference foreignKey="FinanceAccountEUVAT_DimensionCombHeader" />
              <Reference foreignKey="FinanceAccountInvestmentTax_DimensionCombHeader" />
              <Reference foreignKey="SetOffAccountInvestmentTax_DimensionCombHeader" />
              <Reference foreignKey="FinanceAccountBase_DimensionCombHeader" />
            </Group>
            <Group title="Access Level">
              <Reference foreignKey="AccessLevelName_AccessLevelHeader" keyShadowTitle="Name" descriptionShadowTitle="Description" />
            </Group>
            <Group ref="UserUpdateGroup" />
          </Column>
        </Row>
      </Form>
      <Form name="VATSetup" title="G/L Tax Code">
        <Actions all="true">
          <Exclude>
            <Create />
          </Exclude>
        </Actions>
        <Row>
          <Column>
            <Group title="G/L Tax Code">
              <Field source="Name" />
              <If condition="EUAcquisitionVATCode">
                <Field source="EUAcquisitionVATRate" />
              </If>
              <Else>
                <Field source="VATRate" />
              </Else>
              <Field source="VATDirection" open="false" />
              <If condition="VATDirection=VATDirectionType'Receivable">
                <Field source="RatioNumber" />
              </If>
              <Else>
                <Field source="VATNature" mandatory="true" />
              </Else>
              <Field source="VATType" />
              <If condition="maconomy:booleanSysPar('UseMultipleVATLevels')">
                <Field source="FinanceVATLevel" open="false" />
                <If condition="FinanceVATLevel!=VATLevelType'\Tax level 1\">
                  <Boolean source="CalculateVATOfVAT" />
                </If>
              </If>
            </Group>
            <If condition="InvestmentTaxRate != 0">
              <Group title="Investment Tax">
                <Field source="InvestmentTaxRate" />
                <Field source="EntryTextInvestmentTax" />
                <Boolean source="CreateJobEntryInvestmentTax" />
              </Group>
            </If>
          </Column>
          <Column>
            <Group title="Posting References">
              <If condition="RatioNumber != 0">
                <Reference foreignKey="FinanceAccountVAT_DimensionCombHeader" keyMandatory="true" />
              </If>
              <If condition="RatioNumber != 100">
                <Reference foreignKey="FinanceAccountReconciliation_DimensionCombHeader" />
              </If>
              <If condition="EUAcquisitionVATCode">
                <Reference foreignKey="FinanceAccountEUVAT_DimensionCombHeader" keyMandatory="true" />
              </If>
              <If condition="InvestmentTaxRate != 0">
                <Reference foreignKey="FinanceAccountInvestmentTax_DimensionCombHeader" keyMandatory="true" />
                <Reference foreignKey="SetOffAccountInvestmentTax_DimensionCombHeader" keyMandatory="true" />
                <Reference foreignKey="FinanceAccountBase_DimensionCombHeader" />
              </If>
            </Group>
            <Group title="Access Level">
              <Reference foreignKey="AccessLevelName_AccessLevelHeader" keyShadowTitle="Name" descriptionShadowTitle="Description" />
            </Group>
            <Group ref="UserUpdateGroup" />
          </Column>
        </Row>
      </Form>
      <Form name="CreateVATCodePage1">
        <Actions>
          <Create />
        </Actions>
        <Row>
          <Group>
            <Field source="Name" />
            <Field source="VATDirection" />
            <Field source="VATType" />
            <If condition="maconomy:booleanSysPar('UseMultipleVATLevels')">
              <Field source="FinanceVATLevel" />
            </If>
            <Boolean source="EUAcquisitionVATCode" />
            <Field source="InvestmentTaxRate" />
          </Group>
        </Row>
      </Form>
      <Form name="CreateVATCodePage2">
        <Actions>
          <Create />
        </Actions>
        <Row>
          <Group title="G/L Tax Code">
            <If condition="EUAcquisitionVATCode">
              <Field source="EUAcquisitionVATRate" />
            </If>
            <Else>
              <Field source="VATRate" />
            </Else>
            <If condition="VATDirection=VATDirectionType'Receivable">
              <Field source="RatioNumber" />
            </If>
            <Else>
              <Field source="VATNature" mandatory="true" />
            </Else>
            <If condition="FinanceVATLevel!=VATLevelType'\Tax level 1\">
              <Boolean source="CalculateVATOfVAT" />
            </If>
          </Group>
          <If condition="InvestmentTaxRate != 0">
            <Group title="Investment Tax">
              <Field source="EntryTextInvestmentTax" />
              <Boolean source="CreateJobEntryInvestmentTax" />
            </Group>
          </If>
        </Row>
      </Form>
      <Form name="CreateVATCodePage3">
        <Actions>
          <Create />
        </Actions>
        <Row>
          <Group>
            <If condition="RatioNumber != 0">
              <Reference foreignKey="FinanceAccountVAT_DimensionCombHeader" keyMandatory="true" />
            </If>
            <If condition="RatioNumber != 100">
              <Reference foreignKey="FinanceAccountReconciliation_DimensionCombHeader" />
            </If>
            <If condition="EUAcquisitionVATCode">
              <Reference foreignKey="FinanceAccountEUVAT_DimensionCombHeader" keyMandatory="true" />
            </If>
            <If condition="InvestmentTaxRate != 0">
              <Reference foreignKey="FinanceAccountInvestmentTax_DimensionCombHeader" keyMandatory="true" />
              <Reference foreignKey="SetOffAccountInvestmentTax_DimensionCombHeader" />
              <Reference foreignKey="FinanceAccountBase_DimensionCombHeader" />
            </If>
          </Group>
        </Row>
      </Form>
      <Form name="Custom_RoleRestricted_DimensionOrigin" open="false">
        <Actions>
          <Update />
        </Actions>
        <Row>
        <If condition="hasRole('Finance Admin')" >
          <Column style="textAlignment">
            <Group title="G/L Tax Code">
              <Field source="Name" />
              <If condition="EUAcquisitionVATCode">
                <Field source="EUAcquisitionVATRate" />
              </If>
              <Else>
                <Field source="VATRate" />
              </Else>
              <Field source="VATDirection" />
              <If condition="VATDirection=VATDirectionType'Receivable">
                <Field source="RatioNumber" />
              </If>
              <Else>
                <Field source="VATNature" />
              </Else>
              <Field source="VATType" />
              <If condition="maconomy:booleanSysPar('UseMultipleVATLevels')">
                <Field source="FinanceVATLevel" />
                <If condition="FinanceVATLevel!=VATLevelType'\Tax level 1\">
                  <Field source="CalculateVATOfVAT" />
                </If>
              </If>
            </Group>
            <If condition="InvestmentTaxRate != 0">
              <Group title="Investment Tax">
                <Field source="InvestmentTaxRate" />
                <Field source="EntryTextInvestmentTax" />
                <Field source="CreateJobEntryInvestmentTax" />
              </Group>
            </If>
          </Column>
          <Column>
            <Group title="Posting References">
              <If condition="isAccount(FianceAccountVAT)">
                <Reference foreignKey="FinanceAccountVAT_DimensionCombHeader" open="true" style="highlightRow" />
              </If>
              <Else>
                <Reference foreignKey="FinanceAccountVAT_DimensionCombHeader" />
              </Else>
              <If condition="isAccount(FinanceAccountReconciliation)">
                <Reference foreignKey="FinanceAccountReconciliation_DimensionCombHeader" open="true" style="highlightRow" />
              </If>
              <Else>
                <Reference foreignKey="FinanceAccountReconciliation_DimensionCombHeader" />
              </Else>
              <If condition="isAccount(FinanceAccountEUVAT)">
                <Reference foreignKey="FinanceAccountEUVAT_DimensionCombHeader" open="true" style="highlightRow" />
              </If>
              <Else>
                <Reference foreignKey="FinanceAccountEUVAT_DimensionCombHeader" />
              </Else>
              <If condition="isAccount(FinanceAccountInvestmentTax)">
                <Reference foreignKey="FinanceAccountInvestmentTax_DimensionCombHeader" open="true" style="highlightRow" />
              </If>
              <Else>
                <Reference foreignKey="FinanceAccountInvestmentTax_DimensionCombHeader" />
              </Else>
              <If condition="isAccount(FinanceAccountBase)">
                <Reference foreignKey="FinanceAccountBase_DimensionCombHeader" open="true" style="highlightRow" />
              </If>
              <Else>
                <Reference foreignKey="FinanceAccountBase_DimensionCombHeader" />
              </Else>
            </Group>
            <Group title="Access Level">
              <Reference foreignKey="AccessLevelName_AccessLevelHeader" keyShadowTitle="Name" descriptionShadowTitle="Description" />
            </Group>
            <Group ref="UserUpdateGroup" />
          </Column>
        </If>
        <Else>
          <Column style="textAlignment">
            <Group title="G/L Tax Code">
              <Field source="Name" />
              <If condition="EUAcquisitionVATCode">
                <Field source="EUAcquisitionVATRate" />
              </If>
              <Else>
                <Field source="VATRate" />
              </Else>
              <Field source="VATDirection" />
              <If condition="VATDirection=VATDirectionType'Receivable">
                <Field source="RatioNumber" />
              </If>
              <Else>
                <Field source="VATNature" />
              </Else>
              <Field source="VATType" />
              <If condition="maconomy:booleanSysPar('UseMultipleVATLevels')">
                <Field source="FinanceVATLevel" />
                <If condition="FinanceVATLevel!=VATLevelType'\Tax level 1\">
                  <Field source="CalculateVATOfVAT" />
                </If>
              </If>
            </Group>
            <If condition="InvestmentTaxRate != 0">
              <Group title="Investment Tax">
                <Field source="InvestmentTaxRate" />
                <Field source="EntryTextInvestmentTax" />
                <Field source="CreateJobEntryInvestmentTax" />
              </Group>
            </If>
          </Column>
          <Column>
            <Group title="Posting References">
              <If condition="isAccount(FianceAccountVAT)">
                <Reference foreignKey="FinanceAccountVAT_DimensionCombHeader" open="false" style="highlightRow" />
              </If>
              <Else>
                <Reference foreignKey="FinanceAccountVAT_DimensionCombHeader" />
              </Else>
              <If condition="isAccount(FinanceAccountReconciliation)">
                <Reference foreignKey="FinanceAccountReconciliation_DimensionCombHeader" open="false" style="highlightRow" />
              </If>
              <Else>
                <Reference foreignKey="FinanceAccountReconciliation_DimensionCombHeader" />
              </Else>
              <If condition="isAccount(FinanceAccountEUVAT)">
                <Reference foreignKey="FinanceAccountEUVAT_DimensionCombHeader" open="false" style="highlightRow" />
              </If>
              <Else>
                <Reference foreignKey="FinanceAccountEUVAT_DimensionCombHeader" />
              </Else>
              <If condition="isAccount(FinanceAccountInvestmentTax)">
                <Reference foreignKey="FinanceAccountInvestmentTax_DimensionCombHeader" open="false" style="highlightRow" />
              </If>
              <Else>
                <Reference foreignKey="FinanceAccountInvestmentTax_DimensionCombHeader" />
              </Else>
              <If condition="isAccount(FinanceAccountBase)">
                <Reference foreignKey="FinanceAccountBase_DimensionCombHeader" open="false" style="highlightRow" />
              </If>
              <Else>
                <Reference foreignKey="FinanceAccountBase_DimensionCombHeader" />
              </Else>
            </Group>
            <Group title="Access Level">
              <Reference foreignKey="AccessLevelName_AccessLevelHeader" keyShadowTitle="Name" descriptionShadowTitle="Description" />
            </Group>
            <Group ref="UserUpdateGroup" />
          </Column>
        </Else>
        </Row>
      </Form>
      <Form name="DimensionOrigin" open="false">
        <Actions>
          <Update />
        </Actions>
        <Row>
          <Column style="textAlignment">
            <Group title="G/L Tax Code">
              <Field source="Name" />
              <If condition="EUAcquisitionVATCode">
                <Field source="EUAcquisitionVATRate" />
              </If>
              <Else>
                <Field source="VATRate" />
              </Else>
              <Field source="VATDirection" />
              <If condition="VATDirection=VATDirectionType'Receivable">
                <Field source="RatioNumber" />
              </If>
              <Else>
                <Field source="VATNature" />
              </Else>
              <Field source="VATType" />
              <If condition="maconomy:booleanSysPar('UseMultipleVATLevels')">
                <Field source="FinanceVATLevel" />
                <If condition="FinanceVATLevel!=VATLevelType'\Tax level 1\">
                  <Field source="CalculateVATOfVAT" />
                </If>
              </If>
            </Group>
            <If condition="InvestmentTaxRate != 0">
              <Group title="Investment Tax">
                <Field source="InvestmentTaxRate" />
                <Field source="EntryTextInvestmentTax" />
                <Field source="CreateJobEntryInvestmentTax" />
              </Group>
            </If>
          </Column>
          <Column>
            <Group title="Posting References">
              <If condition="isAccount(FianceAccountVAT)">
                <Reference foreignKey="FinanceAccountVAT_DimensionCombHeader" open="true" style="highlightRow" />
              </If>
              <Else>
                <Reference foreignKey="FinanceAccountVAT_DimensionCombHeader" />
              </Else>
              <If condition="isAccount(FinanceAccountReconciliation)">
                <Reference foreignKey="FinanceAccountReconciliation_DimensionCombHeader" open="true" style="highlightRow" />
              </If>
              <Else>
                <Reference foreignKey="FinanceAccountReconciliation_DimensionCombHeader" />
              </Else>
              <If condition="isAccount(FinanceAccountEUVAT)">
                <Reference foreignKey="FinanceAccountEUVAT_DimensionCombHeader" open="true" style="highlightRow" />
              </If>
              <Else>
                <Reference foreignKey="FinanceAccountEUVAT_DimensionCombHeader" />
              </Else>
              <If condition="isAccount(FinanceAccountInvestmentTax)">
                <Reference foreignKey="FinanceAccountInvestmentTax_DimensionCombHeader" open="true" style="highlightRow" />
              </If>
              <Else>
                <Reference foreignKey="FinanceAccountInvestmentTax_DimensionCombHeader" />
              </Else>
              <If condition="isAccount(FinanceAccountBase)">
                <Reference foreignKey="FinanceAccountBase_DimensionCombHeader" open="true" style="highlightRow" />
              </If>
              <Else>
                <Reference foreignKey="FinanceAccountBase_DimensionCombHeader" />
              </Else>
            </Group>
            <Group title="Access Level">
              <Reference foreignKey="AccessLevelName_AccessLevelHeader" keyShadowTitle="Name" descriptionShadowTitle="Description" />
            </Group>
            <Group ref="UserUpdateGroup" />
          </Column>
        </Row>
      </Form>
    </UpperPane>
  </Layout>
</MDML>

